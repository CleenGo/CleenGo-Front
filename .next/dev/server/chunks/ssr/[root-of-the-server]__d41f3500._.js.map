{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/services/http.ts"],"sourcesContent":["import axios from \"axios\";\r\n\r\nexport const http = axios.create({\r\n  baseURL: process.env.VITE_BACKEND_URL || \"http://localhost:3000\",\r\n  withCredentials: true,\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,OAAO,gJAAK,CAAC,MAAM,CAAC;IAC/B,SAAS,8DAAgC;IACzC,iBAAiB;AACnB"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/services/auth.ts"],"sourcesContent":["// src/app/services/auth.ts\r\n\r\nimport { http } from \"./http\";\r\n\r\n// --------- Tipos para registro normal ---------\r\nexport interface RegisterClientRequest {\r\n  name: string;\r\n  surname: string;\r\n  email: string;\r\n  password: string;\r\n  confirmPassword: string;\r\n  birthDate: string;\r\n  profileImgUrl?: string;\r\n  phone: string;\r\n}\r\n\r\nexport interface RegisterClientResponse {\r\n  message: string;\r\n  user: any;\r\n  token?: string; // por si el backend devuelve token al registrar\r\n}\r\n\r\n// --------- Tipos para login normal ---------\r\nexport interface LoginRequest {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nexport interface LoginResponse {\r\n  message: string;\r\n  accessToken: string;\r\n  user: any;\r\n}\r\n\r\n// --------- Tipos para login por terceros (OAuth) ---------\r\nexport interface ThirdPartyLoginRequest {\r\n  accessToken: string;\r\n  name: string | null;\r\n  surname: string | null;\r\n  phone: string | null;\r\n  profileImgUrl: string | null;\r\n}\r\n\r\nexport interface ThirdPartyLoginResponse {\r\n  message: string;\r\n  accessToken: string;\r\n  user: any;\r\n}\r\n\r\n// --------- Servicios ---------\r\nexport async function registerClient(data: RegisterClientRequest) {\r\n  const response = await http.post<RegisterClientResponse>(\r\n    \"/auth/register/client\",\r\n    data\r\n  );\r\n  return response.data;\r\n}\r\n\r\nexport async function login(data: LoginRequest) {\r\n  const response = await http.post<LoginResponse>(\"/auth/login\", data);\r\n  return response.data;\r\n}\r\n\r\n// Login / registro con Google (Supabase OAuth)\r\nexport async function thirdPartyLogin(\r\n  role: \"client\" | \"provider\",\r\n  data: ThirdPartyLoginRequest\r\n) {\r\n  const response = await http.post<ThirdPartyLoginResponse>(\r\n    `/auth/third-party/${role}`,\r\n    data\r\n  );\r\n  return response.data;\r\n}\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;;;AAE3B;;AAgDO,eAAe,eAAe,IAA2B;IAC9D,MAAM,WAAW,MAAM,sIAAI,CAAC,IAAI,CAC9B,yBACA;IAEF,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,MAAM,IAAkB;IAC5C,MAAM,WAAW,MAAM,sIAAI,CAAC,IAAI,CAAgB,eAAe;IAC/D,OAAO,SAAS,IAAI;AACtB;AAGO,eAAe,gBACpB,IAA2B,EAC3B,IAA4B;IAE5B,MAAM,WAAW,MAAM,sIAAI,CAAC,IAAI,CAC9B,CAAC,kBAAkB,EAAE,MAAM,EAC3B;IAEF,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/services/supabaseClient.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.VITE_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.VITE_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  console.error(\r\n    \"‚ùå ERROR: Las variables VITE_SUPABASE_URL o VITE_SUPABASE_ANON_KEY NO est√°n accesibles en el cliente.\"\r\n  );\r\n  throw new Error(\"Faltan variables de entorno de Supabase en el cliente.\");\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAIA,MAAM;AACN,MAAM;AAEN;;AAOO,MAAM,WAAW,IAAA,uMAAY,EAAC,aAAa"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/components/OAuthLoginButton.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { supabase } from \"../services/supabaseClient\";\r\n\r\ninterface OAuthLoginButtonProps {\r\n  role: \"client\" | \"provider\";\r\n}\r\n\r\nexport default function OAuthLoginButton({ role }: OAuthLoginButtonProps) {\r\n  const googleLogo = \"https://www.svgrepo.com/show/475656/google-color.svg\";\r\n\r\n  const handleGoogleLogin = async () => {\r\n    // üî• window SOLO se usa dentro del handler (client-safe)\r\n    const redirectURL = `${window.location.origin}/oauth/callback?role=${role}`;\r\n\r\n    const { error } = await supabase.auth.signInWithOAuth({\r\n      provider: \"google\",\r\n      options: {\r\n        redirectTo: redirectURL,\r\n      },\r\n    });\r\n\r\n    if (error) alert(\"Error al iniciar con Google\");\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={handleGoogleLogin}\r\n      className=\"w-full border px-4 py-2 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-100 transition\"\r\n    >\r\n      <img src={googleLogo} className=\"w-5 h-5\" />\r\n      Continuar con Google\r\n    </button>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAQe,SAAS,iBAAiB,EAAE,IAAI,EAAyB;IACtE,MAAM,aAAa;IAEnB,MAAM,oBAAoB;QACxB,yDAAyD;QACzD,MAAM,cAAc,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,qBAAqB,EAAE,MAAM;QAE3E,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oJAAQ,CAAC,IAAI,CAAC,eAAe,CAAC;YACpD,UAAU;YACV,SAAS;gBACP,YAAY;YACd;QACF;QAEA,IAAI,OAAO,MAAM;IACnB;IAEA,qBACE,8OAAC;QACC,SAAS;QACT,WAAU;;0BAEV,8OAAC;gBAAI,KAAK;gBAAY,WAAU;;;;;;YAAY;;;;;;;AAIlD"}},
    {"offset": {"line": 215, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/contexts/AuthContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  ReactNode,\r\n} from \"react\";\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  surname?: string;\r\n  profileImgUrl?: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  token: string | null;\r\n  login: (user: any, token: string) => void;\r\n  logout: () => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n\r\n  // Mantener sesi√≥n al recargar (solo corre en cliente)\r\n  useEffect(() => {\r\n    const storedUser =\r\n      typeof window !== \"undefined\" ? localStorage.getItem(\"user\") : null;\r\n    const storedToken =\r\n      typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n\r\n    if (storedUser && storedToken) {\r\n      setUser(JSON.parse(storedUser));\r\n      setToken(storedToken);\r\n    }\r\n  }, []);\r\n\r\n  const login = (rawUser: any, token: string) => {\r\n    const normalizedUser: User = {\r\n      id: rawUser.id,\r\n      email: rawUser.email,\r\n      name: rawUser.name || rawUser.full_name || \"\",\r\n      surname: rawUser.surname || \"\",\r\n      profileImgUrl: rawUser.profileImgUrl || rawUser.avatar_url || \"\",\r\n    };\r\n\r\n    setUser(normalizedUser);\r\n    setToken(token);\r\n\r\n    if (typeof window !== \"undefined\") {\r\n      localStorage.setItem(\"user\", JSON.stringify(normalizedUser));\r\n      localStorage.setItem(\"token\", token);\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n    setToken(null);\r\n\r\n    if (typeof window !== \"undefined\") {\r\n      localStorage.removeItem(\"user\");\r\n      localStorage.removeItem(\"token\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, login, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error(\"useAuth debe usarse dentro de un AuthProvider\");\r\n  }\r\n  return context;\r\n};\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAyBA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAExD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,sDAAsD;IACtD,IAAA,kNAAS,EAAC;QACR,MAAM,aACJ,sCAAgC,0BAA+B;QACjE,MAAM,cACJ,sCAAgC,0BAAgC;QAElE;;IAIF,GAAG,EAAE;IAEL,MAAM,QAAQ,CAAC,SAAc;QAC3B,MAAM,iBAAuB;YAC3B,IAAI,QAAQ,EAAE;YACd,OAAO,QAAQ,KAAK;YACpB,MAAM,QAAQ,IAAI,IAAI,QAAQ,SAAS,IAAI;YAC3C,SAAS,QAAQ,OAAO,IAAI;YAC5B,eAAe,QAAQ,aAAa,IAAI,QAAQ,UAAU,IAAI;QAChE;QAEA,QAAQ;QACR,SAAS;QAET;;IAIF;IAEA,MAAM,SAAS;QACb,QAAQ;QACR,SAAS;QAET;;IAIF;IAEA,qBACE,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAO;YAAO;QAAO;kBACvD;;;;;;AAGP;AAEO,MAAM,UAAU;IACrB,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 281, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/altor/Documents/PF65-HENRY/REPOSITORIOS/CleenGo-Front/src/app/components/LoginForm.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, FormEvent } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nimport { login } from \"../services/auth\";\r\nimport OAuthLoginButton from \"./OAuthLoginButton\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\n\r\nexport default function LoginForm() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  const router = useRouter();\r\n  const { login: loginContext } = useAuth();\r\n\r\n  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      const res = await login({ email, password });\r\n\r\n      // Guardamos en el contexto global\r\n      loginContext(res.user, res.accessToken);\r\n\r\n      // Navegaci√≥n en Next\r\n      router.push(\"/\");\r\n    } catch (error) {\r\n      alert(\"Credenciales incorrectas\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white shadow-md rounded-xl p-8 w-full max-w-sm\">\r\n      <h2 className=\"text-2xl font-semibold text-center mb-6\">\r\n        Iniciar Sesi√≥n\r\n      </h2>\r\n\r\n      <form className=\"flex flex-col gap-4\" onSubmit={handleSubmit}>\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\">\r\n            Correo electr√≥nico\r\n          </label>\r\n          <input\r\n            type=\"email\"\r\n            placeholder=\"ejemplo@correo.com\"\r\n            className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0A65FF]\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\">Contrase√±a</label>\r\n          <input\r\n            type=\"password\"\r\n            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n            className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#0A65FF]\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-[#0A65FF] text-white font-medium py-2 rounded-lg hover:opacity-90 transition\"\r\n        >\r\n          Iniciar Sesi√≥n\r\n        </button>\r\n      </form>\r\n\r\n      <div className=\"mt-4\">\r\n        <OAuthLoginButton role=\"client\" />\r\n      </div>\r\n\r\n      <p className=\"text-sm text-center mt-4\">\r\n        ¬øNo tienes cuenta?{\" \"}\r\n        <Link\r\n          href=\"/register\"\r\n          className=\"text-[#0A65FF] font-medium hover:underline\"\r\n        >\r\n          Reg√≠strate aqu√≠\r\n        </Link>\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AARA;;;;;;;;AAUe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,OAAO,YAAY,EAAE,GAAG,IAAA,iJAAO;IAEvC,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,uIAAK,EAAC;gBAAE;gBAAO;YAAS;YAE1C,kCAAkC;YAClC,aAAa,IAAI,IAAI,EAAE,IAAI,WAAW;YAEtC,qBAAqB;YACrB,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,OAAO;YACd,MAAM;QACR;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA0C;;;;;;0BAIxD,8OAAC;gBAAK,WAAU;gBAAsB,UAAU;;kCAC9C,8OAAC;;0CACC,8OAAC;gCAAM,WAAU;0CAAiC;;;;;;0CAGlD,8OAAC;gCACC,MAAK;gCACL,aAAY;gCACZ,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;kCAI5C,8OAAC;;0CACC,8OAAC;gCAAM,WAAU;0CAAiC;;;;;;0CAClD,8OAAC;gCACC,MAAK;gCACL,aAAY;gCACZ,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;kCAI/C,8OAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;0BAKH,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,wJAAgB;oBAAC,MAAK;;;;;;;;;;;0BAGzB,8OAAC;gBAAE,WAAU;;oBAA2B;oBACnB;kCACnB,8OAAC,uKAAI;wBACH,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT"}}]
}